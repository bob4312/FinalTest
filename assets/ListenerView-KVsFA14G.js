import{r as l,o as h,c,e as d,a as r,w as _,b as f,d as w,t as b,v as x,f as I}from"./index-Ffi1KRsG.js";import{$ as k}from"./bundler-CViGtuft.js";const D={style:{padding:"2rem","max-width":"600px",margin:"auto"}},L=["disabled"],M={key:0,style:{color:"gray","font-size":".9rem"}},V={__name:"Listener",setup(g){function p(){return Math.random().toString(36).substring(2,7)}const a=l(p()),u=l(""),n=l(!1),s=l(!1),m=l(null);let i=null,v=null;h(async()=>{try{v=await navigator.mediaDevices.getUserMedia({audio:!0}),s.value=!0}catch(e){console.warn("Listener: mic access denied",e)}i=new k(a.value),i.on("open",e=>{a.value=e,console.log("Listener Peer ready with ID:",e)}),i.on("error",e=>{console.error("PeerJS error (listener):",e),alert("Listener error: "+e)})});function y(){const e=u.value.trim();if(e.length!==5)return alert("Room ID must be exactly 5 characters.");if(!s.value)return alert("Mic not ready; please allow microphone access.");console.log("Calling host:",e);const t=i.call(e,v);t.on("stream",o=>{m.value&&(m.value.srcObject=o,n.value=!0)}),t.on("error",o=>{console.error("Call error:",o),alert("Could not connect to host: "+o)}),t.on("close",()=>{console.log("Host closed the call"),n.value=!1})}return(e,t)=>(d(),c("div",D,[t[2]||(t[2]=r("h2",null,"Listener Mode",-1)),r("p",null,[t[1]||(t[1]=w("Your Listener ID: ")),r("strong",null,b(a.value),1)]),t[3]||(t[3]=r("label",{for:"hostId"},"Enter Room ID:",-1)),_(r("input",{id:"hostId","onUpdate:modelValue":t[0]||(t[0]=o=>u.value=o),placeholder:"e.g. abcde",style:{display:"block",width:"100%",margin:".5rem 0",padding:".5rem"}},null,512),[[x,u.value]]),r("button",{onClick:y,disabled:n.value||!s.value}," ðŸ‘‚ Join Stream ",8,L),s.value?f("",!0):(d(),c("p",M," Allow mic access to connect... ")),n.value?(d(),c("audio",{key:1,ref_key:"remoteAudio",ref:m,autoplay:"",controls:"",style:{display:"block",width:"100%","margin-top":"1rem"}},null,512)):f("",!0)]))}},$={style:{padding:"2rem","max-width":"600px",margin:"auto"}},N={__name:"ListenerView",setup(g){return(p,a)=>(d(),c("div",$,[I(V)]))}};export{N as default};
