import{$ as y}from"./bundler-CViGtuft.js";import{_ as h,r as m,o as b,c as n,a as t,b as p,d as x,t as v,F as w,e as k,f as s,g as I}from"./index-Cwplh_9e.js";const M={style:{padding:"2rem","max-width":"600px",margin:"auto"}},H=["disabled"],$={key:0,style:{"margin-top":"1rem",color:"green"}},D={key:1,style:{"margin-top":"1rem"}},S={key:2,style:{"margin-top":"1.5rem"}},V={__name:"Host",setup(_){function g(){return Math.random().toString(36).substring(2,7)}const l=m(g()),i=m(!1),r=m([]),a=m(null);let u=null,d=null;b(()=>{u=new y(l.value),u.on("open",e=>{l.value=e,console.log("Host Peer ready with ID:",e)}),u.on("error",e=>{console.error("PeerJS error (host):",e),alert("Host error: "+e)}),u.on("call",e=>{if(console.log("Incoming call from listener:",e.peer),!d){alert("Please start your mic first!");return}e.answer(d),r.value.includes(e.peer)||r.value.push(e.peer),e.on("close",()=>{r.value=r.value.filter(o=>o!==e.peer)}),e.on("error",o=>{console.error("Listener connection error:",o),r.value=r.value.filter(c=>c!==e.peer)})})});async function f(){try{d=await navigator.mediaDevices.getUserMedia({audio:!0}),i.value=!0,a.value&&(a.value.srcObject=d,a.value.volume=1,await a.value.play().catch(()=>{}))}catch(e){alert("Could not access mic: "+e.message)}}return(e,o)=>(s(),n("div",M,[o[2]||(o[2]=t("h2",null,"Host Mode",-1)),t("p",null,[o[0]||(o[0]=x("Room ID to share: ")),t("strong",null,v(l.value),1)]),t("button",{onClick:f,disabled:i.value}," ðŸ”Š Start My Mic ",8,H),i.value?(s(),n("p",$," Mic is live â€” listeners can join using that Room ID. ")):p("",!0),i.value?(s(),n("div",D,[o[1]||(o[1]=t("p",null,[t("strong",null,"Your live audio monitor:")],-1)),t("audio",{ref_key:"localAudio",ref:a,autoplay:"",controls:"",playsinline:"",style:{width:"100%"}},null,512)])):p("",!0),r.value.length?(s(),n("div",S,[t("p",null,[t("strong",null,"Connected listeners ("+v(r.value.length)+"):",1)]),t("ul",null,[(s(!0),n(w,null,k(r.value,c=>(s(),n("li",{key:c},v(c),1))),128))])])):p("",!0)]))}},C=h(V,[["__scopeId","data-v-b6be188b"]]),N={style:{padding:"2rem","max-width":"600px",margin:"auto"}},R={__name:"HostVIew",setup(_){return(g,l)=>(s(),n("div",N,[I(C),l[0]||(l[0]=t("h4",null,"hello",-1))]))}};export{R as default};
