import{$ as y}from"./bundler-CViGtuft.js";import{_ as h,r as m,o as b,c as n,a as o,b as p,d as x,t as v,F as w,e as k,f as s,g as I}from"./index-BcyifOd6.js";const M={style:{padding:"2rem","max-width":"600px",margin:"auto"}},H=["disabled"],$={key:0,style:{"margin-top":"1rem",color:"green"}},D={key:1,style:{"margin-top":"1rem"}},S={key:2,style:{"margin-top":"1.5rem"}},V={__name:"Host",setup(g){function _(){return Math.random().toString(36).substring(2,7)}const l=m(_()),i=m(!1),r=m([]),a=m(null);let u=null,c=null;b(()=>{u=new y(l.value),u.on("open",e=>{l.value=e,console.log("Host Peer ready with ID:",e)}),u.on("error",e=>{console.error("PeerJS error (host):",e),alert("Host error: "+e)}),u.on("call",e=>{if(console.log("Incoming call from listener:",e.peer),!c){alert("Please start your mic first!");return}e.answer(c),r.value.includes(e.peer)||r.value.push(e.peer),e.on("close",()=>{r.value=r.value.filter(t=>t!==e.peer)}),e.on("error",t=>{console.error("Listener connection error:",t),r.value=r.value.filter(d=>d!==e.peer)})})});async function f(){try{c=await navigator.mediaDevices.getUserMedia({audio:!0}),i.value=!0,a.value&&(a.value.srcObject=c,a.value.volume=1,await a.value.play().catch(()=>{}))}catch(e){alert("Could not access mic: "+e.message)}}return(e,t)=>(s(),n("div",M,[t[2]||(t[2]=o("h2",null,"Host Mode",-1)),o("p",null,[t[0]||(t[0]=x("Room ID to share: ")),o("strong",null,v(l.value),1)]),o("button",{onClick:f,disabled:i.value}," ðŸ”Š Start My Mic ",8,H),i.value?(s(),n("p",$," Mic is live â€” listeners can join using that Room ID. ")):p("",!0),i.value?(s(),n("div",D,[t[1]||(t[1]=o("p",null,[o("strong",null,"Your live audio monitor:")],-1)),o("audio",{ref_key:"localAudio",ref:a,autoplay:"",controls:"",playsinline:"",style:{width:"100%"}},null,512)])):p("",!0),r.value.length?(s(),n("div",S,[o("p",null,[o("strong",null,"Connected listeners ("+v(r.value.length)+"):",1)]),o("ul",null,[(s(!0),n(w,null,k(r.value,d=>(s(),n("li",{key:d},v(d),1))),128))])])):p("",!0)]))}},C=h(V,[["__scopeId","data-v-b6be188b"]]),N={style:{padding:"2rem","max-width":"600px",margin:"auto"}},R={__name:"HostVIew",setup(g){return(_,l)=>(s(),n("div",N,[I(C)]))}};export{R as default};
