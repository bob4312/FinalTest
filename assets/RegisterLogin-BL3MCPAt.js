import{_ as y,h as A,r as V,c as U,a as e,w as d,v as u,i as _,f as x,u as P,g as E}from"./index-D1wTDwKK.js";import{initializeApp as h}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";import{getFirestore as S,collection as k,addDoc as J,query as q,where as C,getDocs as F}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";import{c as O}from"./index-DZTaDg_Z.js";import"./_commonjsHelpers-gnU0ypJ3.js";const M={id:"RegisterContainer"},z="https://pnaenrrtsasabsbxaeke.supabase.co",B="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBuYWVucnJ0c2FzYWJzYnhhZWtlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg1MjI5ODgsImV4cCI6MjA2NDA5ODk4OH0.bAlA2tC2SPE9F0E5AlGqT_O5Qx8hjHQw7u4MVZXN33Q",N={__name:"Register",setup(R){const p=O(z,B),c=h({apiKey:"AIzaSyAQpMoxAKJrkave5D9e8CqKeLffCCUeGAw",authDomain:"vexa-d596e.firebaseapp.com",projectId:"vexa-d596e",storageBucket:"vexa-d596e.appspot.com",messagingSenderId:"79833394084",appId:"1:79833394084:web:1e5f41859b4125ef342f31"}),g=S(c),m=k(g,"vexaUsers"),o=A({username:"",email:"",password:""}),l=V(null);function w(t){l.value=t.target.files[0],console.log("Selected file:",l.value)}async function a(t,r){const n=q(m,C(t,"==",r));return!(await F(n)).empty}function s(){return"vexapeercodeforstream_"+Math.random().toString(36).substring(2,12)}async function i(){const{username:t,email:r,password:n}=o;if(!t.trim()||!r.trim()||!n.trim()||!l.value){alert("Please fill out all fields and upload an image.");return}if(await a("username",t.trim())){alert("Username is already taken.");return}if(await a("email",r.trim())){alert("Email is already registered.");return}const b=t.trim(),{data:H,error:D}=await p.storage.from("logos").upload(b,l.value,{cacheControl:"3600",upsert:!1,contentType:l.value.type});if(D){console.error("UPLOAD ERROR:",D),alert("Image upload to Supabase failed.");return}const{publicUrl:X,error:L}=p.storage.from("logos").getPublicUrl(b);if(L){console.error("PUBLIC URL ERROR:",L),alert("Failed to get image URL.");return}let v;do v=s();while(await a("PeerID",v));try{const I=await J(m,{username:t.trim(),email:r.trim(),password:n.trim(),PeerID:v,Role:"Vexian",isLiveNow:!1,UsersThatFollowsHim:[],UsersThatHeFollows:[]});alert(`User added with ID: ${I.id}`),o.username="",o.email="",o.password="",l.value=null}catch(I){console.error("Error adding user to Firestore:",I),alert("Failed to add user. See console for details.")}}return(t,r)=>(x(),U("div",M,[r[8]||(r[8]=e("h2",null,"Register",-1)),e("form",{id:"user-form",onSubmit:_(i,["prevent"])},[e("div",null,[r[3]||(r[3]=e("label",{for:"username"},"Username:",-1)),d(e("input",{type:"text",id:"username","onUpdate:modelValue":r[0]||(r[0]=n=>o.username=n),required:"",placeholder:"Enter unique username"},null,512),[[u,o.username]])]),e("div",null,[r[4]||(r[4]=e("label",{for:"email"},"Email:",-1)),d(e("input",{type:"email",id:"email","onUpdate:modelValue":r[1]||(r[1]=n=>o.email=n),required:"",placeholder:"Enter email"},null,512),[[u,o.email]])]),e("div",null,[r[5]||(r[5]=e("label",{for:"password"},"Password:",-1)),d(e("input",{type:"password",id:"password","onUpdate:modelValue":r[2]||(r[2]=n=>o.password=n),required:"",placeholder:"Enter password"},null,512),[[u,o.password]])]),e("div",null,[r[6]||(r[6]=e("label",{for:"profileImage"},"Profile Logo:",-1)),e("input",{type:"file",id:"profileImage",onChange:w,accept:"image/*",required:""},null,32)]),r[7]||(r[7]=e("button",{type:"submit"},"Register",-1))],32)]))}},$=y(N,[["__scopeId","data-v-8500a56e"]]),K={id:"LoginContainer"},T={__name:"Login",setup(R){const f=h({apiKey:"AIzaSyAQpMoxAKJrkave5D9e8CqKeLffCCUeGAw",authDomain:"vexa-d596e.firebaseapp.com",projectId:"vexa-d596e",storageBucket:"vexa-d596e.appspot.com",messagingSenderId:"79833394084",appId:"1:79833394084:web:1e5f41859b4125ef342f31"}),c=S(f),g=k(c,"vexaUsers"),m=P(),o=A({username:"",password:""});function l(a,s,i=7){const t=new Date(Date.now()+i*864e5).toUTCString();document.cookie=`${a}=${encodeURIComponent(s)}; expires=${t}; path=/`}async function w(){const{username:a,password:s}=o;if(!a.trim()||!s.trim()){alert("Please enter both username and password.");return}const i=q(g,C("username","==",a.trim()),C("password","==",s.trim()));(await F(i)).empty?alert("Invalid username or password."):(alert("Login successful!"),l("vexaUser",a.trim()),m.push("/home"))}return(a,s)=>(x(),U("div",K,[s[5]||(s[5]=e("h2",null,"Login",-1)),e("form",{onSubmit:_(w,["prevent"])},[e("div",null,[s[2]||(s[2]=e("label",{for:"username"},"Username:",-1)),d(e("input",{type:"text",id:"username","onUpdate:modelValue":s[0]||(s[0]=i=>o.username=i),required:"",placeholder:"Enter your username"},null,512),[[u,o.username]])]),e("div",null,[s[3]||(s[3]=e("label",{for:"password"},"Password:",-1)),d(e("input",{type:"password",id:"password","onUpdate:modelValue":s[1]||(s[1]=i=>o.password=i),required:"",placeholder:"Enter your password"},null,512),[[u,o.password]])]),s[4]||(s[4]=e("button",{type:"submit"},"Login",-1))],32)]))}},j=y(T,[["__scopeId","data-v-d2cb901b"]]),Q={id:"formsContainer"},Y={id:"registerContainer"},Z={id:"loginContainer"},G={__name:"RegisterLogin",setup(R){return(p,f)=>(x(),U("div",Q,[e("div",Y,[E($)]),e("div",Z,[E(j)])]))}},te=y(G,[["__scopeId","data-v-e781619c"]]);export{te as default};
