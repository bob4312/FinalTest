import{$ as b}from"./bundler-CViGtuft.js";import{_ as y,r as v,o as g,c as i,a as e,b as w,d as _,t as m,n as x,F as I,e as M,f as r,g as k}from"./index-D2_mBT7T.js";const S={class:"host-container"},C={class:"host-card"},D={class:"room-section"},H={class:"room-id-container"},$={class:"room-id"},V={class:"control-section"},L=["disabled"],N={class:"mic-text"},P={key:0,class:"status-indicator"},R={key:0,class:"audio-section"},B={class:"audio-container"},j={key:1,class:"listeners-section"},A={class:"listeners-header"},F={class:"listeners-count"},O={class:"listeners-grid"},z={class:"listener-id"},E={__name:"Host",setup(f){function p(){return Math.random().toString(36).substring(2,7)}const n=v(p()),a=v(!1),o=v([]),l=v(null);let d=null,c=null;g(()=>{d=new b(n.value),d.on("open",t=>{n.value=t,console.log("Host Peer ready with ID:",t)}),d.on("error",t=>{console.error("PeerJS error (host):",t),alert("Host error: "+t)}),d.on("call",t=>{if(console.log("Incoming call from listener:",t.peer),!c){alert("Please start your mic first!");return}t.answer(c),o.value.includes(t.peer)||o.value.push(t.peer),t.on("close",()=>{o.value=o.value.filter(s=>s!==t.peer)}),t.on("error",s=>{console.error("Listener connection error:",s),o.value=o.value.filter(u=>u!==t.peer)})})});async function h(){try{c=await navigator.mediaDevices.getUserMedia({audio:!0}),a.value=!0,l.value&&(l.value.srcObject=c,l.value.volume=1,await l.value.play().catch(()=>{}))}catch(t){alert("Could not access mic: "+t.message)}}return(t,s)=>(r(),i("div",S,[e("div",C,[s[7]||(s[7]=w('<div class="header" data-v-e7b5f4ed><div class="header-content" data-v-e7b5f4ed><h2 class="title" data-v-e7b5f4ed>ğŸ™ï¸ Host Mode</h2><p class="subtitle" data-v-e7b5f4ed>Share your voice with the world</p></div><div class="broadcast-icon" data-v-e7b5f4ed><div class="pulse-ring" data-v-e7b5f4ed></div><div class="broadcast-dot" data-v-e7b5f4ed></div></div></div>',1)),e("div",D,[s[1]||(s[1]=e("p",{class:"room-label"},"Share this Room ID with your listeners:",-1)),e("div",H,[e("div",$,m(n.value),1),s[0]||(s[0]=e("button",{class:"copy-btn",title:"Copy Room ID"}," ğŸ“‹ ",-1))])]),e("div",V,[e("button",{onClick:h,disabled:a.value,class:x(["mic-button",{active:a.value,disabled:a.value}])},[s[2]||(s[2]=e("span",{class:"mic-icon"},"ğŸ”Š",-1)),e("span",N,m(a.value?"Mic is Live":"Start My Mic"),1)],10,L),a.value?(r(),i("div",P,s[3]||(s[3]=[e("div",{class:"live-dot"},null,-1),e("p",{class:"live-text"},"Mic is live â€” listeners can join using that Room ID",-1)]))):_("",!0)]),a.value?(r(),i("div",R,[s[4]||(s[4]=e("h3",{class:"audio-title"},"Your live audio monitor:",-1)),e("div",B,[e("audio",{ref_key:"localAudio",ref:l,autoplay:"",controls:"",playsinline:"",class:"audio-player"},null,512)])])):_("",!0),o.value.length?(r(),i("div",j,[e("div",A,[s[5]||(s[5]=e("h3",{class:"listeners-title"},"Connected Listeners",-1)),e("div",F,m(o.value.length),1)]),e("div",O,[(r(!0),i(I,null,M(o.value,u=>(r(),i("div",{key:u,class:"listener-card"},[s[6]||(s[6]=e("div",{class:"listener-avatar"},"ğŸ‘¤",-1)),e("span",z,m(u),1)]))),128))])])):_("",!0)])]))}},J=y(E,[["__scopeId","data-v-e7b5f4ed"]]),U={style:{padding:"2rem","max-width":"600px",margin:"auto"}},G={__name:"HostVIew",setup(f){return(p,n)=>(r(),i("div",U,[k(J),n[0]||(n[0]=e("h4",null,"hello",-1))]))}};export{G as default};
